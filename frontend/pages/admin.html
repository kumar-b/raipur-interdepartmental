<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard — Raipur Interdepartmental Portal</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="../css/responsive.css" />
</head>
<body>

  <header class="site-header">
    <div class="container">
      <div class="header-top">
        <div class="site-branding">
          <img src="../images/cg-logo.svg" alt="Government of Chhattisgarh Emblem" class="cg-logo" />
          <div class="site-branding-text">
            <span class="site-stamp">Government of Chhattisgarh &mdash; District Raipur</span>
            <a href="../index.html" class="site-title">Raipur Interdepartmental Portal</a>
            <p class="site-tagline">Coordination &bull; Communication &bull; Administration</p>
          </div>
        </div>
        <div class="header-meta" id="header-meta"></div>
      </div>
      <nav class="site-nav" aria-label="Main navigation">
        <button class="nav-toggle" aria-expanded="false" aria-controls="nav-list" id="nav-toggle">&#9776; MENU</button>
        <ul class="nav-list" id="nav-list">
          <li><a href="../index.html">Home</a></li>
          <li><a href="admin.html" class="active">Admin Dashboard</a></li>
          <li><a href="#" id="nav-logout">Logout</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">

      <div class="dash-actionbar">
        <div>
          <h1 style="font-size:1.3rem;">Admin Dashboard</h1>
          <span class="dash-username">District Administration — Raipur</span>
        </div>
        <button class="btn btn-sm" id="refresh-btn">Refresh</button>
      </div>

      <!-- Stat cards -->
      <div class="stat-cards" id="stat-cards">
        <div class="stat-card">
          <span class="stat-number" id="stat-total">—</span>
          <span class="stat-label">Total Notices</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="stat-pending">—</span>
          <span class="stat-label">Pending Actions</span>
        </div>
        <div class="stat-card overdue">
          <span class="stat-number" id="stat-overdue">—</span>
          <span class="stat-label">Overdue Notices</span>
        </div>
      </div>

      <!-- Tabs -->
      <div class="dash-tabs">
        <button class="dash-tab active" data-tab="all-notices">All Notices</button>
        <button class="dash-tab" data-tab="manage-users">Manage Users</button>
        <button class="dash-tab" data-tab="monthly-stats">Monthly Stats</button>
      </div>

      <!-- ALL NOTICES panel -->
      <div class="dash-panel active" id="panel-all-notices">
        <div class="filter-bar" id="admin-notice-filter">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="overdue">Overdue Only</button>
          <button class="filter-btn" data-filter="High">High Priority</button>
          <button class="filter-btn" data-filter="pending">Has Pending</button>
        </div>
        <div class="table-scroll">
          <table class="officials-table" id="admin-notices-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Title</th>
                <th>From</th>
                <th>Priority</th>
                <th>Deadline</th>
                <th>Pending / Total</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="admin-notices-tbody">
              <tr><td colspan="7" class="text-muted text-small" style="padding:1rem;">Loading&hellip;</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- MANAGE USERS panel -->
      <div class="dash-panel" id="panel-manage-users">
        <div style="display:flex; justify-content:flex-end; margin-bottom:1rem;">
          <button class="btn btn-sm" id="create-user-btn">+ Create User</button>
        </div>
        <div class="table-scroll">
          <table class="officials-table" id="users-table">
            <thead>
              <tr>
                <th>Username</th>
                <th>Role</th>
                <th>Department</th>
                <th>Status</th>
                <th>Last Login</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="users-tbody">
              <tr><td colspan="6" class="text-muted text-small" style="padding:1rem;">Loading&hellip;</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- MONTHLY STATS panel -->
      <div class="dash-panel" id="panel-monthly-stats">
        <p style="font-size:0.62rem; letter-spacing:0.15em; text-transform:uppercase; color:var(--muted); margin-bottom:1.5rem;">
          Completed Actions per Month &mdash; District Raipur
        </p>
        <div id="monthly-stats-content">
          <p class="text-muted text-small" style="padding:1rem;">Loading&hellip;</p>
        </div>
      </div>

    </div>
  </main>

  <!-- Notice Detail Modal -->
  <div class="modal-overlay" id="notice-detail-modal">
    <div class="modal-box" id="notice-detail-content">
      <button class="modal-close" id="notice-detail-close">&times;</button>
    </div>
  </div>

  <!-- Create User Modal -->
  <div class="modal-overlay" id="create-user-modal">
    <div class="modal-box">
      <button class="modal-close" id="create-user-close">&times;</button>
      <h2 style="font-size:1rem; margin-bottom:1.5rem;">Create New User</h2>
      <form id="create-user-form">

        <div class="form-group">
          <label for="new-username">Username *</label>
          <input type="text" id="new-username" name="username" placeholder="e.g. dept_revenue_2" required />
        </div>

        <div class="form-group">
          <label for="new-password">Password *</label>
          <input type="password" id="new-password" name="password" placeholder="Min 6 characters" required />
        </div>

        <div class="form-group">
          <label for="new-role">Role *</label>
          <select id="new-role" name="role" required>
            <option value="department">Department</option>
            <option value="admin">Admin</option>
          </select>
        </div>

        <div class="form-group" id="new-dept-group">
          <label for="new-dept">Department *</label>
          <select id="new-dept" name="dept_id">
            <option value="">— Select Department —</option>
          </select>
          <div id="new-dept-name-group" style="display:none; margin-top:0.5rem;">
            <input type="text" id="new-dept-name" placeholder="Enter new department name" />
          </div>
        </div>

        <button type="submit" class="btn">Create User</button>
        <div class="form-status" id="create-user-status"></div>
      </form>
    </div>
  </div>

  <!-- Reset Password Modal -->
  <div class="modal-overlay" id="reset-pw-modal">
    <div class="modal-box" style="max-width:400px;">
      <button class="modal-close" id="reset-pw-close">&times;</button>
      <h2 style="font-size:1rem; margin-bottom:1.5rem;">Reset Password</h2>
      <form id="reset-pw-form">
        <input type="hidden" id="reset-pw-uid" />
        <p class="text-muted text-small" id="reset-pw-label" style="margin-bottom:1rem;"></p>
        <div class="form-group">
          <label for="reset-pw-input">New Password *</label>
          <input type="password" id="reset-pw-input" name="newPassword" placeholder="Min 6 characters" required />
        </div>
        <button type="submit" class="btn">Reset Password</button>
        <div class="form-status" id="reset-pw-status"></div>
      </form>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-bottom">
        &copy; <span id="footer-year"></span> District Administration Raipur, Government of Chhattisgarh.
      </div>
    </div>
  </footer>

  <script src="../js/main.js"></script>
  <script src="../js/admin.js"></script>
</body>
</html>
